<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <title>Warframe æ ¸æ¡ƒæ‰ç‡ä¸æˆ˜ç”²è®¡ç®—å™¨</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    html, body {
      margin: 0;
      padding: 0;
      background: #111;
      color: #f0f0f0;
      font-family: sans-serif;
      min-height: 100vh;
    }

    body {
      display: flex;
      justify-content: center;
    }

    .container {
      display: flex;
      flex-wrap: wrap;
      gap: 20px;
      justify-content: center;
      max-width: 1280px;
      width: 100%;
      padding: 20px;
      margin: auto;
    }

    .section {
      flex: 1;
      min-width: 320px;
      max-width: 600px;
      background-color: #1a1a1a;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 0 10px #000;
    }

    h2 {
      color: #5ad;
      border-bottom: 1px solid #333;
      padding-bottom: 4px;
    }

    label {
      display: block;
      margin-top: 12px;
    }

    input, select {
      padding: 6px;
      background-color: #222;
      color: #fff;
      border: 1px solid #555;
      border-radius: 4px;
      margin-top: 5px;
    }

    input {
      width: 100%;
      max-width: 300px;
    }

    select {
      width: 100%;
      max-width: 300px;
    }

    .input-row {
      display: flex;
      align-items: center;
      gap: 10px;
      flex-wrap: wrap;
      margin-top: 5px;
    }

    .input-row input {
      max-width: 100px;
    }

    .input-row select {
      flex: 1;
      min-width: 150px;
    }

    #result1, #result2 {
      margin-top: 20px;
      font-weight: bold;
      white-space: pre-wrap;
      background-color: #222;
      padding: 12px;
      border-radius: 6px;
      border: 1px solid #444;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="section">
      <h2>ğŸ“¦ åŠŸèƒ½ 1ï¼šé¢„è®¡è·å¾—éƒ¨ä»¶æ•°</h2>
      <label for="relic">è¯·é€‰æ‹©å¼€æ ¸æ¡ƒæ–¹å¼ï¼š</label>
      <select id="relic"></select>
      <label for="count">è¯·è¾“å…¥è®¡åˆ’å¼€æ ¸æ¡ƒçš„æ•°é‡ï¼š</label>
      <input type="number" id="count" min="0" value="0">
      <div id="result1">ğŸ¯ é¢„è®¡è·å¾—éƒ¨ä»¶æ•°ï¼š--</div>
    </div>
    <div class="section">
      <h2>ğŸ›  åŠŸèƒ½ 2ï¼šè®¡ç®—å‡‘é½æˆ˜ç”²æ‰€éœ€æ ¸æ¡ƒæ•°é‡</h2>
      <label>è¯·è¾“å…¥æƒ³è¦çš„æˆ˜ç”²æ€»æ•°ï¼š</label>
      <input type="number" id="total" min="1" value="1">
      <label>å·²æœ‰å¤´éƒ¨æ•°ï¼š</label>
      <div class="input-row">
        <input type="number" id="head" min="0" value="0">
        <select id="drop_neuroptics"></select>
      </div>
      <label>å·²æœ‰ç³»ç»Ÿæ•°ï¼š</label>
      <div class="input-row">
        <input type="number" id="system" min="0" value="0">
        <select id="drop_systems"></select>
      </div>
      <label>å·²æœ‰æœºä½“æ•°ï¼š</label>
      <div class="input-row">
        <input type="number" id="chassis" min="0" value="0">
        <select id="drop_chassis"></select>
      </div>
      <label>å·²æœ‰è“å›¾æ•°ï¼š</label>
      <div class="input-row">
        <input type="number" id="blueprint" min="0" value="0">
        <select id="drop_blueprint"></select>
      </div>
      <div id="result2">ğŸ’¡ è¯·è¾“å…¥æ•°æ®</div>
    </div>
  </div>
  <script>
    const probability = [...Array(14).keys()].map((_, i) => ({
      id: i + 1,
      name: [
        "å…‰è¾‰ä¸€æ³¢(é‡‘)", "å…‰è¾‰22è½®(é‡‘)", "å…‰è¾‰22è½®(é“¶)", "æ— æš‡22è½®(é“¶)", "æ— æš‡ä¸€æ³¢(é“¶)", "å®Œæ•´ä¸€æ³¢(é“œ)", "å®Œæ•´22è½®(é“œ)",
        "å…‰è¾‰ä¸€æ³¢(é“¶)", "å…‰è¾‰22è½®(é“œ)", "æ— æš‡ä¸€æ³¢(é‡‘)", "æ— æš‡ä¸€æ³¢(é“œ)", "æ— æš‡22è½®(é“œ)", "å®Œæ•´ä¸€æ³¢(é“¶)", "å®Œæ•´22è½®(é“¶)"
      ][i],
      value: [0.3439, 0.19, 0.36, 0.3111, 0.525417, 0.689126, 0.442439, 0.5904, 0.297253, 0.219251, 0.525417, 0.36, 0.372578, 0.2079][i],
      half: [false, true, true, true, false, false, true, false, true, false, false, true, false, true][i]
    }));

    const partKeys = ['neuroptics', 'systems', 'chassis', 'blueprint'];
    const partLabels = {
      neuroptics: 'å¤´éƒ¨',
      systems: 'ç³»ç»Ÿ',
      chassis: 'æœºä½“',
      blueprint: 'è“å›¾'
    };

    function getDropInfo(id) {
      return probability.find(item => item.id === parseInt(id));
    }

    function initDropSelectors() {
      const relicSelect = document.getElementById('relic');
      probability.forEach(item => {
        const option = document.createElement('option');
        option.value = item.id;
        option.textContent = `${item.name} (æ‰ç‡: ${item.value})`;
        relicSelect.appendChild(option);
      });
      partKeys.forEach(key => {
        const select = document.getElementById(`drop_${key}`);
        probability.forEach(item => {
          const option = document.createElement('option');
          option.value = item.id;
          option.textContent = `${item.name} (æ‰ç‡ ${item.value})`;
          select.appendChild(option);
        });
      });
    }

    initDropSelectors();

    function calcDropResult() {
      const relic = getDropInfo(document.getElementById('relic').value);
      const count = parseInt(document.getElementById('count').value);
      const result1 = document.getElementById('result1');
      if (!relic || isNaN(count)) {
        result1.textContent = "âŒ æ— æ•ˆè¾“å…¥";
        return;
      }
      const effectiveCount = relic.half ? count * 2 : count;
      const expected = Math.floor(effectiveCount * relic.value);
      result1.textContent = `ğŸ¯ ä½¿ç”¨ã€${relic.name}ã€‘ï¼Œæ‰ç‡ä¸º ${relic.value.toFixed(4)}ï¼Œå¼€ ${count} ä¸ªæ ¸æ¡ƒ
ğŸ‘‰ é¢„è®¡è·å¾—éƒ¨ä»¶æ•°çº¦ä¸ºï¼š${expected} ä¸ªï¼ˆå‘ä¸‹å–æ•´ï¼‰`;
    }

    document.getElementById('relic').addEventListener('change', calcDropResult);
    document.getElementById('count').addEventListener('input', calcDropResult);
    calcDropResult();

    const ids = ['total', 'head', 'system', 'chassis', 'blueprint'];
    ids.forEach(id => document.getElementById(id).addEventListener('input', calcTotalWalnuts));
    partKeys.forEach(key => document.getElementById(`drop_${key}`).addEventListener('change', calcTotalWalnuts));

    function calcTotalWalnuts() {
      const total = parseInt(document.getElementById('total').value);
      const current = {
        neuroptics: parseInt(document.getElementById('head').value),
        systems: parseInt(document.getElementById('system').value),
        chassis: parseInt(document.getElementById('chassis').value),
        blueprint: parseInt(document.getElementById('blueprint').value)
      };
      if (isNaN(total) || total <= 0) {
        document.getElementById('result2').textContent = "â— è¯·è¾“å…¥æ­£ç¡®çš„æˆ˜ç”²æ•°é‡";
        return;
      }
      let sum = 0;
      let lines = `ğŸ“Š ç›®æ ‡ï¼š${total} ä¸ªæˆ˜ç”²
`;
      for (const part in current) {
        const have = current[part];
        const relicId = document.getElementById(`drop_${part}`).value;
        const info = getDropInfo(relicId);
        const diff = total - have;
        if (!info) continue;
        if (diff > 0) {
          const count = Math.ceil(diff / info.value);
          const realCount = info.half ? Math.ceil(count / 2) : count;
          lines += `ğŸ”§ ${partLabels[part]} è¿˜éœ€ ${diff} ä¸ªï¼Œæ–¹å¼ï¼š${info.name}ï¼Œæ‰ç‡ ${info.value.toFixed(4)}ï¼Œé¢„è®¡éœ€æ ¸æ¡ƒ ${realCount} ä¸ª
`;
          sum += realCount;
        } else if (diff === 0) {
          lines += `âœ… ${partLabels[part]} æ•°é‡åˆšå¥½ï¼Œæ— éœ€è·å–
`;
        } else {
          lines += `âœ… ${partLabels[part]} å·²å¤šä½™ ${-diff} ä¸ª
`;
        }
      }
      lines += `
ğŸ”” æ€»å…±é¢„è®¡éœ€è¦æ ¸æ¡ƒï¼š${sum} ä¸ª`;
      document.getElementById('result2').textContent = lines;
    }

    calcTotalWalnuts();
  </script>
</body>
</html>